{% extends "base.html" %}

{% block title %}Contact & Feedback | ROMHACKS.NET{% endblock %}

{% block meta_description %}Contact us to report broken links, request corrections, or provide feedback about ROM hacks and decompiled ports.{% endblock %}
{% block meta_keywords %}contact romhacks, report broken link, feedback, rom hack support, request correction{% endblock %}

{% block content %}
<div class="max-w-4xl mx-auto mb-12">
    <div class="mb-12">
        <h1 class="text-4xl font-bold text-white mb-3 pixel-font">Contact & Feedback</h1>
        <p class="text-gray-400 text-lg">Found an issue? Have feedback? We'd love to hear from you! Help us keep the community and database accurate.</p>
    </div>

    <div class="bg-gradient-to-br from-blue-900/20 to-gray-900/20 border border-blue-500/30 p-6 rounded-lg mb-12">
        <div class="flex gap-3 items-start">
            <span class="material-symbols-outlined text-blue-400 text-lg mt-1 flex-shrink-0">info</span>
            <div class="text-sm text-blue-300 leading-relaxed">
                <p><strong>Response Time:</strong> We typically respond to reports within 24-48 hours during business days. All submissions are reviewed carefully and help us improve the site.</p>
            </div>
        </div>
    </div>

    <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-12">
        <!-- Report Broken Link -->
        <div class="bg-gradient-to-br from-red-900/20 to-gray-900/50 border border-red-500/30 p-6 rounded-lg backdrop-blur-sm hover:border-red-500/50 transition-all">
            <div class="flex items-start gap-3 mb-4">
                <span class="material-symbols-outlined text-red-400 text-2xl flex-shrink-0">link_off</span>
                <div>
                    <h3 class="text-lg font-bold text-red-400">Broken Link</h3>
                    <p class="text-xs text-red-300 mt-1">Download or resource dead</p>
                </div>
            </div>
            <p class="text-sm text-gray-400 mb-4 leading-relaxed">Found a broken download link or inaccessible resource? Report it and we'll investigate and fix it as soon as possible.</p>
            <button class="w-full bg-red-600 hover:bg-red-700 text-white font-bold py-2 px-4 rounded-lg transition text-sm" onclick="openFeedbackModal('broken-link')">
                <span class="material-symbols-outlined text-sm align-middle mr-1">flag</span> Report
            </button>
        </div>
        
        <!-- Request Correction -->
        <div class="bg-gradient-to-br from-blue-900/20 to-gray-900/50 border border-blue-500/30 p-6 rounded-lg backdrop-blur-sm hover:border-blue-500/50 transition-all">
            <div class="flex items-start gap-3 mb-4">
                <span class="material-symbols-outlined text-blue-400 text-2xl flex-shrink-0">edit</span>
                <div>
                    <h3 class="text-lg font-bold text-blue-400">Correction Request</h3>
                    <p class="text-xs text-blue-300 mt-1">Inaccurate information</p>
                </div>
            </div>
            <p class="text-sm text-gray-400 mb-4 leading-relaxed">Noticed incorrect game info, wrong author, or bad description? Let us know what needs to be fixed and we'll verify and update it.</p>
            <button class="w-full bg-blue-600 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded-lg transition text-sm" onclick="openFeedbackModal('correction')">
                <span class="material-symbols-outlined text-sm align-middle mr-1">edit_note</span> Request
            </button>
        </div>

        <!-- General Feedback -->
        <div class="bg-gradient-to-br from-amber-900/20 to-gray-900/50 border border-amber-500/30 p-6 rounded-lg backdrop-blur-sm hover:border-amber-500/50 transition-all">
            <div class="flex items-start gap-3 mb-4">
                <span class="material-symbols-outlined text-amber-400 text-2xl flex-shrink-0">feedback</span>
                <div>
                    <h3 class="text-lg font-bold text-amber-400">General Feedback</h3>
                    <p class="text-xs text-amber-300 mt-1">Suggestions & ideas</p>
                </div>
            </div>
            <p class="text-sm text-gray-400 mb-4 leading-relaxed">Have a suggestion for the site, found a bug, or want to share feedback? We're always looking to improve the community platform.</p>
            <button class="w-full bg-amber-600 hover:bg-amber-700 text-white font-bold py-2 px-4 rounded-lg transition text-sm" onclick="openFeedbackModal('feedback')">
                <span class="material-symbols-outlined text-sm align-middle mr-1">lightbulb</span> Share
            </button>
        </div>
    </div>

    <!-- Direct Contact Section -->
    <div class="bg-[#1a1a20] border border-gray-700/50 rounded-lg p-8 mb-12">
        <h2 class="text-2xl font-bold text-white mb-6 flex items-center gap-2">
            <span class="material-symbols-outlined text-blue-400">mail</span>
            Direct Contact
        </h2>
        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
            <div>
                <h3 class="text-white font-bold mb-2">Email</h3>
                <p class="text-gray-400 text-sm mb-2">For urgent issues or detailed reports:</p>
                <a href="mailto:support@romhacks.net" class="inline-flex items-center gap-2 text-blue-400 hover:text-blue-300 transition font-mono text-sm">
                    <span class="material-symbols-outlined text-sm">mail</span>
                    support@romhacks.net
                </a>
            </div>
        </div>
    </div>
</div>

<!-- Feedback Modal -->
<div class="fixed inset-0 bg-black/90 z-50 hidden flex items-center justify-center p-4 backdrop-blur-sm" id="feedback-modal">
    <div class="bg-[#1a1a20] w-full max-w-lg border border-blue-500/30 shadow-2xl relative flex flex-col p-8 rounded-lg max-h-[90vh] overflow-y-auto">
        <button class="absolute top-4 right-4 text-gray-400 hover:text-white text-xl" onclick="closeFeedbackModal()">
            <span class="material-symbols-outlined">close</span>
        </button>
        
        <h2 class="text-2xl font-bold text-white mb-6 pixel-font" id="modal-title">Report Issue</h2>
        
        <div class="space-y-4 mb-6">
            <div id="status-div" class="hidden p-4 rounded text-sm font-bold"></div>
            
            <div>
                <label class="block text-xs text-gray-500 uppercase mb-1">Issue Type</label>
                <select id="feedback-type" class="input-dark w-full">
                    <option value="">Select a type...</option>
                    <option value="broken-link">Broken Link</option>
                    <option value="correction">Correction Request</option>
                    <option value="feedback">General Feedback</option>
                </select>
            </div>
            
            <div>
                <label class="block text-xs text-gray-500 uppercase mb-1">Game Title</label>
                <input type="text" id="feedback-title" class="input-dark" placeholder="e.g., Pokemon Fire Red Enhanced">
            </div>
            
            <div>
                <label class="block text-xs text-gray-500 uppercase mb-1">URL (if broken link)</label>
                <input type="url" id="feedback-url" class="input-dark" placeholder="https://...">
            </div>
            
            <div>
                <label class="block text-xs text-gray-500 uppercase mb-1">Description</label>
                <textarea id="feedback-description" class="input-dark w-full h-24 resize-none" placeholder="Please describe the issue..."></textarea>
            </div>
            
            <div>
                <label class="block text-xs text-gray-500 uppercase mb-1">Email (optional)</label>
                <input type="email" id="feedback-email" class="input-dark" placeholder="your@email.com">
            </div>
        </div>
        
        <div class="flex gap-3">
            <button class="flex-1 bg-gray-700 hover:bg-gray-600 text-white font-bold py-2 px-4 rounded transition" onclick="closeFeedbackModal()">
                Cancel
            </button>
            <button class="flex-1 bg-blue-600 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded transition" onclick="submitFeedback()">
                Submit
            </button>
        </div>
    </div>
</div>

<style>
    .input-dark {
        @apply bg-[#0f0f12] border border-gray-700 rounded px-3 py-2 text-white placeholder-gray-600 focus:outline-none focus:border-blue-500 transition;
    }
</style>

<script>
    function openFeedbackModal(type, options = { reset: true }) {
        const modal = document.getElementById('feedback-modal');
        const typeSelect = document.getElementById('feedback-type');
        const modalTitle = document.getElementById('modal-title');
        
        typeSelect.value = type;
        if (type === 'broken-link') {
            modalTitle.textContent = 'Report Broken Link';
        } else {
            modalTitle.textContent = 'Request Correction';
        }
        
        // Reset form
        if (options.reset) {
            document.getElementById('feedback-title').value = '';
            document.getElementById('feedback-url').value = '';
            document.getElementById('feedback-description').value = '';
            document.getElementById('feedback-email').value = '';
            document.getElementById('status-div').classList.add('hidden');
        }

        if (options.title) {
            document.getElementById('feedback-title').value = options.title;
        }
        
        modal.classList.remove('hidden');
    }
    
    document.addEventListener('DOMContentLoaded', () => {
        const urlParams = new URLSearchParams(window.location.search);
        const type = urlParams.get('type');
        const title = urlParams.get('title');

        if (type) {
             openFeedbackModal(type, { reset: false, title: title });
        }
    });
    
    function closeFeedbackModal() {
        document.getElementById('feedback-modal').classList.add('hidden');
    }
    
    function submitFeedback() {
        const type = document.getElementById('feedback-type').value;
        const title = document.getElementById('feedback-title').value;
        const url = document.getElementById('feedback-url').value;
        const description = document.getElementById('feedback-description').value;
        const email = document.getElementById('feedback-email').value;
        const statusDiv = document.getElementById('status-div');
        
        if (!type) {
            statusDiv.textContent = '❌ Please select an issue type';
            statusDiv.classList.remove('hidden', 'text-green-400');
            statusDiv.classList.add('text-red-400');
            return;
        }
        
        if (!description.trim()) {
            statusDiv.textContent = '❌ Please describe the issue';
            statusDiv.classList.remove('hidden', 'text-green-400');
            statusDiv.classList.add('text-red-400');
            return;
        }
        
        fetch('/api/feedback', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
            },
            body: JSON.stringify({
                type: type,
                title: title,
                url: url,
                description: description,
                email: email
            })
        })
        .then(response => response.json())
        .then(data => {
            if (data.success) {
                statusDiv.textContent = '✅ Thank you! Your feedback has been submitted.';
                statusDiv.classList.remove('hidden', 'text-red-400');
                statusDiv.classList.add('text-green-400');
                
                // Close modal after 2 seconds
                setTimeout(() => {
                    closeFeedbackModal();
                }, 2000);
            } else {
                statusDiv.textContent = '❌ Error: ' + (data.message || 'Failed to submit feedback');
                statusDiv.classList.remove('hidden', 'text-green-400');
                statusDiv.classList.add('text-red-400');
            }
        })
        .catch(error => {
            statusDiv.textContent = '❌ Error submitting feedback: ' + error;
            statusDiv.classList.remove('hidden', 'text-green-400');
            statusDiv.classList.add('text-red-400');
        });
    }
</script>
{% endblock %}
